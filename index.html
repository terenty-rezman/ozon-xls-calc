<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <script src="https://cdn.jsdelivr.net/npm/danfojs@1.1.2/lib/bundle.min.js"></script>
<title>ozon xls calc</title>
</head>

<body>
    <div id="one"></div>
    <input type="file" id="file" name="file">
    <script>
        const inputFile = document.querySelector('#file');
        const one = document.querySelector('#one');
        let b;
        let df; 

        inputFile.addEventListener("change", async () => {
            const excelFile = inputFile.files[0]
            const columns_count = 17;

            let dtypes = [
                "datetime", "string", "string", "datetime", "string", "int32", "string", "string"
            ] 

            // rest columns are float32
            for (let i = dtypes.length; i < 17; i++) {
                dtypes.push("float32");
            }

            dfd.readExcel(excelFile, {frameConfig: {dtypes: dtypes}}).then((ldf) => {
                df = ldf;
                df = df.loc({ rows: df['Тип начисления'].eq('Доставка покупателю') });
                console.log(df)
                // global_df = global_df.asType("Дата начисления", "int32")
            })
        })
         
    </script>
</body>

</html>